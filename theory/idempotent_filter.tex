\RequirePackage{iftex}
\RequirePDFTeX
\NeedsTeXFormat{LaTeX2e}
\documentclass[10pt]{article}
\usepackage{ismll-packages}
\usepackage{ismll-mathoperators}
\usepackage{ismll-style}
\usepackage{unicode-symbols}

\title{Neural Filtering for State Space Models}
\author{Randolf Scholz}
\begin{document}

\maketitle

A filter is a function $Fï¼šğ“§âŠ•ğ“¨ âŸ¶ ğ“§$, that, given an observation $yâˆˆğ“¨$ and a state $xâˆˆğ“§$ returns an updated state estimate $x'âˆˆğ“§$
%
\begin{align*}%
x' = F(x, y)%
\end{align*}%
%
We say a filter is \emph{autoregressive}, if $ğ“¨=ğ“§$ ($ğ“¨={^âˆ™}\!ğ“§$ including nan values), i.e. the observation space $ğ“¨$ is equal to the state space $ğ“§$. In this case we usually write $x^\text{obs}$ instead of $y$.
%
We say an autoregressive filter is \emph{idempotent}, if and only if $xâ‰¡x^\text{obs} âŸ¹ x' = x$.\footnote{$uâ‰¡v$ if $uáµ¢=váµ¢$ for all non-nan components.}
More specifically, we say a filter is continuously (differentiably) idempotent, if $F(x, x^\text{obs}) = G(x-x^\text{obs})$ for some continuous (differentiable) function $G$ with $zâ‰¡0 âŸ¹ G(z)=0$.
%
We also consider the problem of dealing with multiple simultaneous measurements. In this case, we ask that the filter should be order-independent, for which there are 2 options:


\begin{outline}%
\1 satisfy $F(F(x, yâ‚), yâ‚‚) = F(F(x, yâ‚‚), yâ‚)$
\1 change the filter to accept multiple y-values: $Fï¼šğ“§âŠ•â‹ƒ_{nâˆˆâ„•}ğ“¨â¿ âŸ¶ ğ“§$ such that $F(x, Y) = F(x, Pâ‹…Y)$ for any permutation matrix $P$.
\end{outline}%

Additionally, it should satisfy a certain scale invariance:





%
\begin{example}[Linear Filter]%
\label{ex: label}%
We say a filter is \emph{linear}, if it is of the form $F(x,y) = Ax + By$. When is such a filter order-independent?
%
\begin{align*}%
F(F(x, yâ‚), yâ‚‚) = F(F(x, yâ‚), yâ‚‚)
&âŸº A(Ax+Byâ‚) + Byâ‚‚ = A(Ax+Byâ‚‚) + Byâ‚
\\&âŸº AByâ‚ + Byâ‚‚ = AByâ‚‚ + Byâ‚ %
\\&âŸº AB(yâ‚-yâ‚‚) = B(yâ‚-yâ‚‚)
\\&âŸº (ğ•€-A)B(yâ‚-yâ‚‚) = 0
\end{align*}%
%
Since the equality must hold all combinations of $yâ‚$ and $yâ‚‚$, it follows that $(ğ•€-A)B=0$, i.e. $B=AB$.
%
Alternatively, consider the multi-value linear filter $f(x, Y) = Ax + g(Y)$, where $gï¼šğ“¨^{âŠ•â„•}âŸ¶ğ“§$ is linear. We can show such $g$ are of the form $g(Y) = ğŸâ‚™^âŠ¤ Y B$.

\end{example}%



\begin{example}[conditional filtering]

Consider a linear control system
%
\begin{align*}%
\dot{x} &= Ax + Bu + Î½ \\%
y &= Cx + Du + Ï‰
\end{align*}%
%
In this situation, we consider \emph{conditional filters} that have an additional input:
%
\begin{align*}%
Fï¼šğ“§âŠ•ğ“¨âŠ•ğ“¤ âŸ¶ ğ“§, (x, y, u) âŸ¼ x' %
\end{align*}%
%
\end{example}



\section{The Classical Kalman Filter}

The classical Kalman Filter is an analytical result that assumes a normal distribution evolving under linear dynamics. Since the family of normal distributions is closed under linear transformations, the distribution is normal for all times $t$.

%
\begin{lemma}[Normal distribution under linear ODE]%
\label{lem: linear ODE normal}%

Consider the stochastic linear system $Ì‡x(t) = A(t)x(t) + f(t) + Î½$, such that $x(tâ‚€)âˆ¼ğ“(xâˆ£Î¼â‚€ï¼ŒÎ£â‚€)$. Then $xâ‚œâˆ¼ğ“(xâˆ£Î¼â‚œï¼ŒÎ£â‚œ)$ with

Technically we  need to do Ito calculus here.



%
\begin{align*}%
\dot{Î£}(t) &= AÎ£(t) + Î£(t)A^âŠ¤ + GQG^âŠ¤ - Î£HR^{-1}H^âŠ¤Î£(t)%
\end{align*}%
%


\begin{proof}

Without noise:

Then this simply becomes a standard Linear System. We consider several cases


\begin{enumerate}%
	\item LTI homogeneous
	\item LTI inhomogeneous
	\item LTI + LTV inhomogeneity.
	\item LTV homogeneous
	\item LTV inhomogenous
\end{enumerate}%



\begin{align*}%
math%
\end{align*}%
%
\end{proof}
%






%
\end{lemma}%








\end{document}
